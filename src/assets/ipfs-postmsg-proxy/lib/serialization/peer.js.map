{"version":3,"sources":["../../src/serialization/peer.js"],"names":["peerInfoFromJson","obj","peerIdFromJson","id","then","peerId","peerInfo","multiaddrs","forEach","multiaddr","add","_connectedMultiaddr","connect","peerInfoToJson","__ipfsPostMsgProxyType","peerIdToJson","toArray","map","isPeerInfo","isPeerInfoJson","prePeerInfoFromJson","index","args","prePeerInfoToJson","Promise","resolve","reject","createFromJSON","err","Object","assign","toJSON","isPeerId","isPeerIdJson","prePeerIdFromJson","prePeerIdToJson"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;AAEO,IAAMA,8CAAmB,SAAnBA,gBAAmB,CAACC,GAAD,EAAS;AACvC,SAAOC,eAAeD,IAAIE,EAAnB,EACJC,IADI,CACC,UAACC,MAAD,EAAY;AAChB,QAAMC,WAAW,uBAAaD,MAAb,CAAjB;;AAEAJ,QAAIM,UAAJ,CAAeC,OAAf,CAAuB,UAACC,SAAD,EAAe;AACpCH,eAASC,UAAT,CAAoBG,GAApB,CAAwB,kCAAkBD,SAAlB,CAAxB;AACD,KAFD;;AAIA,QAAIR,IAAIU,mBAAR,EAA6B;AAC3BL,eAASM,OAAT,CAAiB,kCAAkBX,IAAIU,mBAAtB,CAAjB;AACD;;AAED,WAAOL,QAAP;AACD,GAbI,CAAP;AAcD,CAfM;;AAiBA,IAAMO,0CAAiB,SAAjBA,cAAiB,CAACP,QAAD;AAAA,SAAe;AAC3CQ,4BAAwB,UADmB;AAE3CX,QAAIY,aAAaT,SAASH,EAAtB,CAFuC;AAG3CI,gBAAYD,SAASC,UAAT,CAAoBS,OAApB,GAA8BC,GAA9B,4BAH+B;AAI3CN,yBAAqBL,SAASK,mBAAT,GACjB,gCAAgBL,SAASK,mBAAzB,CADiB,GAEjB;AANuC,GAAf;AAAA,CAAvB;;AASA,IAAMO,kCAAa,mBAASA,UAA5B;AACA,IAAMC,0CAAiB,SAAjBA,cAAiB,CAAClB,GAAD;AAAA,SAASA,OAAOA,IAAIa,sBAAJ,KAA+B,UAA/C;AAAA,CAAvB;;AAEA,IAAMM,oDAAsB,SAAtBA,mBAAsB,CAACC,KAAD,EAAW;AAC5C,SAAO,YAAa;AAAA,sCAATC,IAAS;AAATA,UAAS;AAAA;;AAClB,QAAIH,eAAeG,KAAKD,KAAL,CAAf,CAAJ,EAAiC;AAC/BC,WAAKD,KAAL,IAAcrB,iBAAiBsB,KAAKD,KAAL,CAAjB,CAAd;AACD;AACD,WAAOC,IAAP;AACD,GALD;AAMD,CAPM;;AASA,IAAMC,gDAAoB,SAApBA,iBAAoB,CAACF,KAAD,EAAW;AAC1C,SAAO,YAAa;AAAA,uCAATC,IAAS;AAATA,UAAS;AAAA;;AAClB,QAAIJ,WAAWI,KAAKD,KAAL,CAAX,CAAJ,EAA6B;AAC3BC,WAAKD,KAAL,IAAcR,eAAeS,KAAKD,KAAL,CAAf,CAAd;AACD;AACD,WAAOC,IAAP;AACD,GALD;AAMD,CAPM;;AASA,IAAMpB,0CAAiB,SAAjBA,cAAiB,CAACD,GAAD;AAAA,SAAS,IAAIuB,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtE,qBAAOC,cAAP,CAAsB1B,GAAtB,EAA2B,UAAC2B,GAAD,EAAMvB,MAAN,EAAiB;AAC1C,UAAIuB,GAAJ,EAAS,OAAOF,OAAOE,GAAP,CAAP;AACTH,cAAQpB,MAAR;AACD,KAHD;AAID,GALsC,CAAT;AAAA,CAAvB;;AAOA,IAAMU,sCAAe,SAAfA,YAAe,CAACV,MAAD;AAAA,SAAYwB,OAAOC,MAAP,CACtC,EAAEhB,wBAAwB,QAA1B,EADsC,EAEtCT,OAAO0B,MAAP,EAFsC,CAAZ;AAAA,CAArB;;AAKA,IAAMC,8BAAW,iBAAOA,QAAxB;AACA,IAAMC,sCAAe,SAAfA,YAAe,CAAChC,GAAD;AAAA,SAASA,OAAOA,IAAIa,sBAAJ,KAA+B,QAA/C;AAAA,CAArB;;AAEA,IAAMoB,gDAAoB,SAApBA,iBAAoB,CAACb,KAAD,EAAW;AAC1C,SAAO,YAAa;AAAA,uCAATC,IAAS;AAATA,UAAS;AAAA;;AAClB,QAAIW,aAAaX,KAAKD,KAAL,CAAb,CAAJ,EAA+B;AAC7BC,WAAKD,KAAL,IAAcnB,eAAeoB,KAAKD,KAAL,CAAf,CAAd;AACD;AACD,WAAOC,IAAP;AACD,GALD;AAMD,CAPM;;AASA,IAAMa,4CAAkB,SAAlBA,eAAkB,CAACd,KAAD,EAAW;AACxC,SAAO,YAAa;AAAA,uCAATC,IAAS;AAATA,UAAS;AAAA;;AAClB,QAAIU,SAASV,KAAKD,KAAL,CAAT,CAAJ,EAA2B;AACzBC,WAAKD,KAAL,IAAcN,aAAaO,KAAKD,KAAL,CAAb,CAAd;AACD;AACD,WAAOC,IAAP;AACD,GALD;AAMD,CAPM","file":"peer.js","sourcesContent":["import PeerInfo from 'peer-info'\nimport PeerId from 'peer-id'\nimport { multiaddrToJson, multiaddrFromJson } from './multiaddr'\n\nexport const peerInfoFromJson = (obj) => {\n  return peerIdFromJson(obj.id)\n    .then((peerId) => {\n      const peerInfo = new PeerInfo(peerId)\n\n      obj.multiaddrs.forEach((multiaddr) => {\n        peerInfo.multiaddrs.add(multiaddrFromJson(multiaddr))\n      })\n\n      if (obj._connectedMultiaddr) {\n        peerInfo.connect(multiaddrFromJson(obj._connectedMultiaddr))\n      }\n\n      return peerInfo\n    })\n}\n\nexport const peerInfoToJson = (peerInfo) => ({\n  __ipfsPostMsgProxyType: 'PeerInfo',\n  id: peerIdToJson(peerInfo.id),\n  multiaddrs: peerInfo.multiaddrs.toArray().map(multiaddrToJson),\n  _connectedMultiaddr: peerInfo._connectedMultiaddr\n    ? multiaddrToJson(peerInfo._connectedMultiaddr)\n    : null\n})\n\nexport const isPeerInfo = PeerInfo.isPeerInfo\nexport const isPeerInfoJson = (obj) => obj && obj.__ipfsPostMsgProxyType === 'PeerInfo'\n\nexport const prePeerInfoFromJson = (index) => {\n  return (...args) => {\n    if (isPeerInfoJson(args[index])) {\n      args[index] = peerInfoFromJson(args[index])\n    }\n    return args\n  }\n}\n\nexport const prePeerInfoToJson = (index) => {\n  return (...args) => {\n    if (isPeerInfo(args[index])) {\n      args[index] = peerInfoToJson(args[index])\n    }\n    return args\n  }\n}\n\nexport const peerIdFromJson = (obj) => new Promise((resolve, reject) => {\n  PeerId.createFromJSON(obj, (err, peerId) => {\n    if (err) return reject(err)\n    resolve(peerId)\n  })\n})\n\nexport const peerIdToJson = (peerId) => Object.assign(\n  { __ipfsPostMsgProxyType: 'PeerId' },\n  peerId.toJSON()\n)\n\nexport const isPeerId = PeerId.isPeerId\nexport const isPeerIdJson = (obj) => obj && obj.__ipfsPostMsgProxyType === 'PeerId'\n\nexport const prePeerIdFromJson = (index) => {\n  return (...args) => {\n    if (isPeerIdJson(args[index])) {\n      args[index] = peerIdFromJson(args[index])\n    }\n    return args\n  }\n}\n\nexport const prePeerIdToJson = (index) => {\n  return (...args) => {\n    if (isPeerId(args[index])) {\n      args[index] = peerIdToJson(args[index])\n    }\n    return args\n  }\n}\n"]}